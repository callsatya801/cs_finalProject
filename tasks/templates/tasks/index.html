{% extends "tasks/base.html" %} {% block title %} Simple Planner {% endblock %} {% block body %}
<div id="wrapper">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{% url 'home' %}">Simple Planner</a>
        </div>
        <!-- /.navbar-header -->

        <ul class="nav navbar-top-links navbar-right">
            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    <strong> {{user}} </strong> <i class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i>
                </a>
                <ul class="dropdown-menu dropdown-user">
                    <li><a href="#"><i class="fa fa-user fa-fw"></i> User Profile</a>
                    </li>
                    <li class="divider"></li>
                    <li><a href="{% url 'logout' %}"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                    </li>
                </ul>
                <!-- /.dropdown-user -->
            </li>
            <!-- /.dropdown -->
        </ul>
        <!-- /.navbar-top-links -->
        <div class="navbar-default sidebar" role="navigation">
            <div class="sidebar-nav navbar-collapse">
                <ul class="nav" id="side-menu">
                    <li class="sidebar-search">
                        <div class="input-group custom-search-form">
                            <input type="text" class="form-control" placeholder="Search...">
                            <span class="input-group-btn">
                                    <button class="btn btn-default" type="button">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </span>
                        </div>
                        <!-- /input-group -->
                    </li>
                    <li>
                        <a href="{% url 'home' %}"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <h5>
                            <i class="fa fa-folder-open fa-fw"></i>
                            <strong>Active Projects</strong>
                        </h5>
                    </li>
                    <li class="divider"></li>

                    <li>
                        <a href="#"><i class="fa fa-user"></i>Personal<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            {% for proj in projectDict.Active_Personal %}
                            <li>
                                <a data-projectid="{{ proj.id }}" href="{% url 'project'  proj.id  %}">{{proj.name}}</a>
                            </li>
                            {% endfor %}
                        </ul>
                        <!-- /.nav-second-level -->
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-group fa-fw"></i> Team<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            {% for proj in projectDict.Active_Team %}
                            <li>
                                <a data-projectid="{{ proj.id }}" href="{% url 'project' proj.id  %}">{{proj.name}}</a>
                            </li>
                            {% endfor %}
                        </ul>
                        <!-- /.nav-second-level -->
                    </li>
                    <li class="divider"></li>
                    <li>
                        <h5>
                            <i class="fa  fa-archive fa-fw"></i>
                            <strong>Archive Projects</strong>
                        </h5>
                    </li>
                    <li class="divider"></li>

                    <li>
                        <a href="#"><i class="fa fa-user"></i>Personal<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            {% for proj in projectDict.Archive_Personal %}
                            <li>
                                <a data-projectid="{{ proj.id }}" href="{% url 'project' proj.id  %}">{{proj.name}}</a>
                            </li>
                            {% endfor %}
                        </ul>
                        <!-- /.nav-second-level -->
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-group fa-fw"></i> Team<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            {% for proj in projectDict.Archive_Personal %}
                            <li>
                                <a data-projectid="{{ proj.id }}" href="{% url 'project'  proj.id  %}">{{proj.name}}</a>
                            </li>
                            {% endfor %}
                        </ul>
                        <!-- /.nav-second-level -->
                    </li>

                    <li>
                        <a href="tables.html"><strong><i class="fa fa-plus-circle fa-fw"></i> Create Project </strong></a>
                    </li>
                </ul>
            </div>
            <!-- /.sidebar-collapse -->
        </div>
        <!-- /.navbar-static-side -->
    </nav>

    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="page-header">{{currentProject.name}}</h3>
                <div id="pg_msg_area">
                {% if task_creation %} {% if task_creation.success %}
                <div id="msg_succ" class="alert alert-success" role="alert">
                    {{task_creation.message}}
                </div>
                {% else %}
                <div id="msg_fail" class="alert alert-danger" role="alert">
                    {{task_creation.message}}
                </div>
                {% endif %} {% endif %}
                </div>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">
            {% for bucket in buckets %}
            <div class="col-lg-4" id="bucketAccordion_{{bucket.id}}">
                <div class="panel panel-primary">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#bucketAccordion_{{bucket.id}}" href="#bucketBody_{{bucket.id}}" aria-expanded="true">
                        <i class="fa fa-tasks fa-fw"></i> {{bucket.name}}
                        <div class="pull-right">
                            <button type="button" class="btn btn-default btn-xs add_task_bttn" data-projectid="{{currentProject.id}}" data-bucketid="{{bucket.id}}" data-teammembers="{{teammembers}}"><i class="fa fa-plus px-2"></i> Add Task </button>
                        </div>
                    </div>
                    <!-- /.panel-heading -->
                    <div class="panel-body" id="bucketBody_{{bucket.id}}">
                        {% for key, tasks in bTaskDict.items %}
                        {%if key == bucket.name %}
                        {% for task in tasks %}
                       <form id="task_edit_form_{{task.id}}" action="{% url 'updatetask' %}" method="post">
                        {% csrf_token %}
                        <!-- /.task_edit -->
                        <div id="task_edit_{{task.id}}" class="panel panel-default task_edit" style="display:none;">

                            <input name="taskid_update" type="hidden" value="{{task.id}}" required/>
                            <input name="projectid_update" type="hidden" value="{{currentProject.id}}" required/>

                            <div class="panel-heading" data-toggle="collapse" data-parent="#bucketBody_{{bucket.id}}" href="#taskBody_{{task.id}}" aria-expanded="true">
                                <input class="form-control form-control-sm" name="title_{{task.id}}" id="title_{{task.id}}" type="text" value="{{task.title}}" placeholder="{{task.title}}" />
                            </div>
                            <!-- /.panel-heading -->
                            <div class="panel-body" id="taskBody_{{task.id}}">
                                <textarea type="text" id="desc_{{task.id}}" name="desc_{{task.id}}" class="form-control" rows="3">{{task.description}}</textarea>
                            </div>
                            <!-- /.panel-body -->
                            <div class="panel-footer">
                                Assigned To:
                                <select name="assignto_{{task.id}}" id="assignto_{{task.id}}" class="form-control form-control-sm">
                                    {% for assign in QO_teammembers %} {% if assign.user.username == task.assignedTo %}
                                    <option value="{{assign.user.id}}" selected>{{assign.user.username}}</option>
                                    {% else %}
                                    <option value="{{assign.user.id}}" selected>{{assign.user.username}}</option>
                                    {% endif %} {% endfor %}
                                </select>
                                Due-Date:
                                <input class="form-control form-control-sm" name="duedate_{{task.id}}" id="duedate_{{task.id}}" type="date" value={ {task.dueDate}} required/>
                                <div class="pull-right">
                                    <button type="submit" class="btn btn-primary btn-xs task_save" data-taskid="{{task.id}}"><i class="fa fa-save px-2"></i> Save </button>
                                </div>
                            </div>
                        </div>                        <!-- /.task_edit -->
                        </form>

                        <!-- /.task_ro -->
                        <div id="task_ro_{{task.id}}" class="panel panel-default task_ro">
                            <div class="panel-heading" data-toggle="collapse" data-parent="#bucketBody_{{bucket.id}}" href="#taskBody_{{task.id}}" aria-expanded="true">
                                <div> {{task.title}}
                                    <div class="pull-right">
                                        <button data-taskid={{task.id}} type="button" class="btn btn-primary btn-xs task_edit_btn"><i class="fa fa-edit px-2"></i></button>
                                        {%if task.owner == user %}
                                        <button type="button" class="btn btn-danger btn-xs"><i class="fa fa-times px-2"></i></button>
                                        {% endif %}
                                        <div class="btn-group">
                                            <button type="button" class="btn btn-success btn-xs dropdown-toggle" data-toggle="dropdown">
                                                <i class="fa fa-arrows-h fa-fw"></i> Move Task
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right" role="menu">
                                                {% for l_bucket in buckets %} {% if l_bucket.name != bucket.name %}
                                                <li><a href="#">{{l_bucket.name}}</a></li>
                                                {% endif %} {% endfor %}
                                            </ul>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <!-- /.panel-heading -->
                            <div class="panel-body" id="taskBody_ro_{{task.id}}">
                                {{task.description}}
                            </div>
                            <!-- /.panel-body -->
                            <div class="panel-footer" id="task_ro_footer_{{task.id}}">
                                Assigned To: <strong>{{task.assignedTo}}</strong> {% if task.dueDate %} Due-Date: <strong>{{task.dueDate}}</strong> {% endif %}
                            </div>
                        </div>
                        <!-- /.task_ro -->

                        {% endfor %}

                        <!---------New Task Creation------------- -->
                        <form id="new_task_form_{{bucket.id}}" action="{% url 'createtask' %}" method="post">
                            {% csrf_token %}
                        </form>
                        <!-- /.Task form -->

                        {% endif %} {% endfor %}
                    </div>

                    <!-- /.panel-body -->
                    <div class="panel-footer">
                        Panel Footer
                    </div>

                </div>
                <!-- /.panel -->
            </div>
            <!-- /.col-lg-4 -->
            {% endfor %}
        </div>
        <!-- /.row -->
    </div>
    <!-- /#page-wrapper -->

</div>
<!-- /#wrapper -->
{% endblock %}